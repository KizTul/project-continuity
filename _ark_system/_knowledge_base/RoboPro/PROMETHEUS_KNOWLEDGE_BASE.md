АРТЕФАКТ: БАЗА ЗНАНИЙ PROMETHEUS v3.0 (Мануал для Профессионала)
ГЛАВА 1: ФИЛОСОФИЯ ROBO PRO — ДВА ПОТОКА
Это — самый важный принцип. Его понимание — ключ ко всему. Представьте, что вы — шеф-повар, а программа — это рецепт.
Синие линии (Поток Управления): Это шаги в рецепте. "Шаг 1: Возьми миску. Шаг 2: Разбей яйцо. Шаг 3: Включи миксер". Это активные команды, которые определяют ПОСЛЕДОВАТЕЛЬНОСТЬ и ВРЕМЯ действий. Блок не начнет работать, пока до него не дойдет "импульс" по синей линии.
Оранжевые линии (Поток Данных): Это ингредиенты. Яйца, молоко, мука. Они пассивны. Они просто существуют и содержат значение (число, текст). Они не могут действовать сами по себе. Блок, получивший синюю команду "Работай!", обращается к своим оранжевым входам, чтобы узнать, С ЧЕМ ему работать.
Ключевой вывод: Нельзя подключить поток команд (синий) ко входу, который ожидает данные (оранжевый), и наоборот. Это как пытаться "выполнить" яйцо или "измерить" команду "Включи миксер".
ГЛАВА 2: АППАРАТНАЯ ПЛАТФОРМА (КОНТРОЛЛЕР ROBOTICS TXT)
2.1. Основные порты и их функции:
Входы I1..I8 (Универсальные): Могут работать как цифровые (для кнопок, фототранзисторов) или аналоговые (для датчиков цвета, NTC резисторов).
Выходы O1..O8 (Однополюсные): Для устройств, не требующих смены полярности: лампы, электромагнитные клапаны, компрессоры.
Выходы M1..M4 (Двухполюсные): Для двигателей постоянного тока, позволяют управлять направлением (реверс).
Входы C1..C4 (Аппаратные счетчики): Для энкодеров. В ROBO Pro представлены как виртуальные цифровые входы C1D, C2D, C3D, C4D.
2.2. Архитектура "Master/Extension" (IF1/EM1):
Принцип: Два контроллера, соединенные кабелем EXT, работают как единая система под управлением одной программы.
Никакой ручной синхронизации не требуется. Блоки Subprogram I/O или глобальные переменные не используются для обмена командами.
Реализация: Выбор нужного контроллера (IF1 для Master, EM1..EM8 для Extension) осуществляется в выпадающем меню Контроллер / Расширение в свойствах каждого блока, работающего с портами.
2.3. Процедура калибровки датчика цвета:
Единственно верный метод: Через встроенное меню контроллера.
Последовательность: Нажать кнопку TEST на экране контроллера. Для нужного входа (например, I1) установить режим Аналог 10В датчик кольору. Меню начнет отображать текущие числовые значения.
ГЛАВА 3: ИНСТРУМЕНТАРИЙ (СЛОВАРЬ КЛЮЧЕВЫХ БЛОКОВ)
3.1. Блоки, Управляющие Потоком (Синяя линия)
Цифровое разветвление (Digital Branch):
Где: Базовые элементы. Иконка: Ромб с портом (I1).
Функция: Ждет состояния (0 или 1) на цифровом порту. Логика: программа ждет в цикле на выходе "0" и продолжает по выходу "1" при срабатывании.
Ждать вход (Wait for input):
Где: Базовые элементы. Иконка: Параллелограмм с символом "фронта".
Функция: Ждет изменения состояния (например, с 0 на 1). Более точный способ "поймать" событие.
Аналоговое разветвление (Analog Branch):
Где: Ответвления, ожидания.... Иконка: Ромб с условием (A>0).
Функция: Сравнивает значение с оранжевого входа A с числом, заданным внутри свойств. Управляет потоком по веткам Y/N.
Счетчик импульсов (Pulse counter):
Где: Базовые элементы. Иконка: Параллелограмм с числом и портом.
Функция: Останавливается и ждет, пока на аппаратном счетчике (C1D-C4D) не будет насчитано заданное количество импульсов. Сбрасывается в ноль автоматически при каждом новом вызове.
3.2. Блоки, Работающие с Данными (Оранжевая линия)
Универсальный вход (из группы Ввод и вывод):
Иконка: Прямоугольник с портом (I1).
Функция: Не останавливает программу. Просто считывает текущее значение с порта и выдает его на свой оранжевый выход. Единственно верный способ получить аналоговое значение для дальнейшей обработки.
Команда:
Где: Команды. Иконка: Узкий белый блок (= 0, STOP).
Функция: Получает синюю команду, "выстреливает" приказом по оранжевой линии для изменения другого элемента (переменной или счетчика (Reset)).
Оператор:
Где: Операторы. Иконка: Широкий синий блок (A+B).
Функция: "Калькулятор". Принимает данные по оранжевым входам, выполняет операцию, выдает результат на оранжевый выход.
Переменная / Константа:
Где: Переменные, таймеры. Иконка: Оранжевый прямоугольник.
Функция: Пассивное хранилище данных.
3.3. Подпрограммы и Интерфейс
Вход/Выход подпрограммы (Entry/Exit): Обозначают начало и конец внутри подпрограммы. Exit можно переименовать, создавая несколько уникальных выходов для ветвления.
Вызов подпрограммы: Зеленый блок, который появляется автоматически в Loaded programs после создания подпрограммы.
Текстовый дисплей (Var=):
Ключевой принцип: Связь с переменной осуществляется по имени, а не проводами. Если имя переменной (RESULT) содержится в тексте дисплея (RESULT=), дисплей автоматически отобразит ее значение.
ГЛАВА 4: ПРОВЕРЕННЫЕ ИНЖЕНЕРНЫЕ ПАТТЕРНЫ
4.1. Паттерн: Самодостаточная подпрограмма
Принцип: Подпрограмма должна решать одну, четко определенную задачу и не зависеть от внешнего оборудования, не относящегося к ней напрямую.
Пример: Color_Identification_Cycle не должна содержать датчики I2 или I3. Ее задача — только сканировать и определять цвет. Управление потоком (ожидание детали) — задача Main program.
4.2. Паттерн: Цикл "ПОКА" (while) для сканирования
Задача: Выполнять действие, пока деталь находится между двумя датчиками.
Реализация:
"Входные ворота": Ожидание на датчике I2.
"Управляющие ворота": Цифровое разветвление на датчике I3.
Тело цикла: Выход "0" из I3 ведет на логику, которая должна повторяться.
Замыкание: Выход из "тела" цикла возвращается на вход I3.
Выход из цикла: Выход "1" из I3 ведет к следующему этапу.
4.3. Паттерн: Поиск минимального значения (защита от шума)
Задача: Найти самое стабильное значение аналогового датчика за время сканирования.
Реализация (внутри цикла "ПОКА"):
Инициализация (до цикла): Переменная min_color = 3000.
Внутри цикла:
a. Универсальный вход I1 считывает значение в temp_color.
b. Сравнение A?B сравнивает min_color (на A) и temp_color (на B).
c. Если B <= A, то Команда = обновляет min_color значением из temp_color. Иначе — не обновляет.
Фиксация (после цикла): Значение из min_color копируется в final_color.
4.4. Паттерн: "Дирижер" (Финальная Main program)
Принцип: Основная программа не должна содержать сложной логики. Она должна состоять из последовательности вызовов подпрограмм, каждая из которых решает свою задачу.
Пример (из Задания 5):
Включить компрессор.
Ждать деталь.
Запустить конвейер.
Вызвать Color_Identification_Cycle.
В зависимости от результата, вызвать Push_White, Push_Red или Push_Blue.
Подождать 5 секунд.
Остановить конвейер.
Вернуться к ожиданию.
АРТЕФАКТ: БАЗА ЗНАНИЙ PROMETHEUS v3.1 (Мануал для Профессионала) [ОБНОВЛЕНО]
ГЛАВА 1: ФИЛОСОФИЯ ROBO PRO — ДВА ПОТОКА
Это — самый важный принцип. Его понимание — ключ ко всему. Представьте, что вы — шеф-повар, а программа — это рецепт.
Синие линии (Поток Управления): Это шаги в рецепте. "Шаг 1: Возьми миску. Шаг 2: Разбей яйцо. Шаг 3: Включи миксер". Это активные команды, которые определяют ПОСЛЕДОВАТЕЛЬНОСТЬ и ВРЕМЯ действий. Блок не начнет работать, пока до него не дойдет "импульс" по синей линии.
Оранжевые линии (Поток Данных): Это ингредиенты. Яйца, молоко, мука. Они пассивны. Они просто существуют и содержат значение (число, текст). Они не могут действовать сами по себе. Блок, получивший синюю команду "Работай!", обращается к своим оранжевым входам, чтобы узнать, С ЧЕМ ему работать.
Ключевой вывод: Нельзя подключить поток команд (синий) ко входу, который ожидает данные (оранжевый), и наоборот. Это как пытаться "выполнить" яйцо или "измерить" команду "Включи миксер".
ГЛАВА 2: АППАРАТНАЯ ПЛАТФОРМА (КОНТРОЛЛЕР ROBOTICS TXT)
2.1. Основные порты и их функции:
Входы I1..I8 (Универсальные): Могут работать как цифровые или аналоговые. [НОВОЕ] Ключевой нюанс цифрового режима: По умолчанию, вход в "свободном" состоянии (кнопка не нажата) выдает сигнал 1. Вход в "сработавшем" состоянии (кнопка нажата) выдает сигнал 0.
Выходы O1..O8 (Однополюсные): Для устройств, не требующих смены полярности: лампы, электромагнитные клапаны, компрессоры.
Выходы M1..M4 (Двухполюсные): Для двигателей постоянного тока, позволяют управлять направлением (реверс).
Входы C1..C4 (Аппаратные счетчики): Для энкодеров. Представлены в двух видах: CxC (числовое значение) и CxD (цифровой сигнал).
[НОВОЕ] Виртуальные входы M1E..M4E: Логические входы, не существующие на контроллере. Они автоматически выдают сигнал 1, когда соответствующий мотор завершил движение на заданную дистанцию.
2.2. Архитектура "Master/Extension" (IF1/EM1):
(Без изменений)
2.3. Процедура калибровки датчика цвета:
(Без изменений)
ГЛАВА 3: ИНСТРУМЕНТАРИЙ (СЛОВАРЬ КЛЮЧЕВЫХ БЛОКОВ)
3.1. Блоки, Управляющие Потоком (Синяя линия)
(Без изменений)
3.2. Блоки, Работающие с Данными (Оранжевая линия)
(Без изменений)
3.3. Подпрограммы и Интерфейс
Entry/Exit (Вход/Выход подпрограммы): Обозначают начало и конец выполнения Потока Управления. Обязательны для любой подпрограммы.
[НОВОЕ] In/Out (Информационный Вход/Выход): Обозначают "порты" для Потока Данных. Используются для динамической передачи значений в/из подпрограммы во время ее работы. Необязательны.
[НОВОЕ] Параметры элемента (Синие шестиугольники): Механизм для статической конфигурации блоков внутри подпрограммы перед ее запуском. Создается в свойствах блока Entry, но не является потоком данных.
Вызов подпрограммы: Зеленый блок... (Без изменений)
Текстовый дисплей (Var=): (Без изменений)
3.4. [НОВОЕ] Блоки Управления Движением
Motor, one direction (Простой мотор): Подает постоянное питание на порт. Не останавливается сам. Используется для простых задач или для калибровки, где остановка происходит по внешнему датчику.
Motor, encoder controlled (Мотор с энкодером): "Умный" блок.
Режим "Дистанция": Дает мотору асинхронную команду "проехать X импульсов". Не останавливает программу. Для ожидания завершения необходимо использовать блок "Ждать вход" на соответствующем виртуальном входе MxE.
Команда "Дистанция 0": Является документированным способом обнуления аппаратного счетчика энкодера.
ГЛАВА 4: ПРОВЕРЕННЫЕ ИНЖЕНЕРНЫЕ ПАТТЕРНЫ
(Все предыдущие паттерны сохранены)
[НОВОЕ] 4.5. Паттерн: "Адаптер" (Связь "Мозга" и "Железа")
Задача: Соединить универсальную, сложную подпрограмму ("мозг", например, AxisEngine) с конкретным физическим оборудованием ("железом").
Реализация: Создается простая подпрограмма-"адаптер" (например, PositionAxis_X), которая содержит:
Вызов "мозга" (AxisEngine).
Блоки, представляющие реальные датчики (I3, C3C).
Блок, представляющий реальный мотор (M3).
Входной параметр (In) для получения целевой координаты.
Принцип: "Адаптер" "подключает провода": выходы реальных датчиков к входам "мозга", и выходы "мозга" к входам реального мотора.
[НОВОЕ] 4.6. Паттерн: "Возврат в Ноль" (Homing/Калибровка)
Задача: Гарантированно установить ось в известное начальное положение.
Реализация:
Проверка: Сначала проверить, не нажат ли уже концевой выключатель. Если да — завершить.
Движение: Дать команду мотору двигаться в сторону выключателя (CCW).
Ожидание: Использовать блок "Ждать вход", чтобы дождаться нажатия на выключатель.
Остановка и Сброс: Использовать последовательность STOP -> Пауза -> Дистанция 0 для надежной остановки и обнуления счетчика.
ПРИНЦИП #A10: "ПРИНЦИП ЭВОЛЮЦИОННОГО АНАЛИЗА"
МНЕ ЗАПРЕЩЕНО РАССМАТРИВАТЬ КАЖДУЮ ПОДПРОГРАММУ ИЗОЛИРОВАННО, ИГНОРИРУЯ ЕЕ РОЛЬ В ОБЩЕЙ ЭВОЛЮЦИИ ПРОЕКТА. ЕСЛИ Я ОБНАРУЖИВАЮ МОДУЛЬ, КОТОРЫЙ КАЖЕТСЯ НЕОПТИМАЛЬНЫМ ИЛИ ОГРАНИЧЕННЫМ ПО ФУНКЦИОНАЛУ (НАПР., Simple_Move_*), Я ОБЯЗАН СНАЧАЛА ВЫДВИНУТЬ ГИПОТЕЗУ О ЕГО ВОЗМОЖНОМ "УСТАРЕВАНИИ" ВНУТРИ ПРОЕКТА. ПЕРЕД ТЕМ, КАК КЛАССИФИЦИРОВАТЬ ЕГО КАК ОШИБКУ, Я ОБЯЗАН ЗАДАТЬ НАПАРНИКУ УТОЧНЯЮЩИЙ ВОПРОС О ЕГО НАЗНАЧЕНИИ, НАПРИМЕР: "ЯВЛЯЕТСЯ ЛИ ЭТА ПОДПРОГРАММА УСТАРЕВШЕЙ ВЕРСИЕЙ, ОСТАВЛЕННОЙ ДЛЯ ДЕМОНСТРАЦИИ, ИЛИ ОНА ИСПОЛЬЗУЕТСЯ В ОСНОВНОМ ЦИКЛЕ?". ЭТО ПОЗВОЛИТ ИЗБЕЖАТЬ КРИТИКИ КОРРЕКТНОГО, НО СПЕЦИАЛИЗИРОВАННОГО ИЛИ УЧЕБНОГО КОДА.